# v1.3.0 发布说明

发布日期：2026-02-27

## 亮点

- 新增自主升级体系：支持检查更新、交互升级提示与双通道升级（npm / GitHub 脚本）。
- 升级检查默认按“早/午/晚”三时段执行，减少重复打扰并保持版本新鲜度。
- 无交互模式新增 `check_update` / `upgrade` 动作，适配 AI Agent 自动化流程。

## 主要变更

- 新增 `src/updater.js`：
  - SemVer 比较与通道过滤（`stable` / `pre`）
  - npm 优先、GitHub 回退的版本检查
  - 升级命令执行与状态结构化
- `wecom-cleaner-agent` 技能适配升级能力：
  - 新增 `check_update_report.sh`（更新检查任务卡片）
  - 新增 `upgrade_report.sh`（升级预演/执行任务卡片）
- `src/cli.js` 接入升级全流程：
  - 无交互：`--check-update`、`--upgrade`
  - 交互：发现新版本后可选择升级方式、稍后提醒或跳过该版本
- `src/config.js`/`src/doctor.js` 增强：
  - 持久化 `selfUpdate` 配置
  - doctor 新增升级配置检查项

## 质量与修复

- 修复 `scripts/install-skill.sh` 的 shellcheck 告警（SC2088）。
- 修复 E2E start menu 用例与新增菜单项不一致的问题。
- 修复 Zig `--ping` 返回版本与应用版本不一致的问题。
- 发布门禁通过：`npm run release:gate`（含覆盖率门禁、shellcheck、e2e smoke、打包预演）。

## 资产

- npm 包：`wecom-cleaner-1.3.0.tgz`
- GitHub Release 附件：
  - `wecom-cleaner-core-v1.3.0-darwin-x64`
  - `wecom-cleaner-core-v1.3.0-darwin-arm64`
  - `wecom-cleaner-core-v1.3.0-SHA256SUMS.txt`

SHA256：

- `1ea550528055b97e26a76de7d33ca7c445f7dcedf36b21c0cfe1ef7e0f9841bf` `wecom-cleaner-core-v1.3.0-darwin-x64`
- `2819be9b6108435d94f9a6f5cd0f4e219c335925239366f76fe8a22da023a736` `wecom-cleaner-core-v1.3.0-darwin-arm64`
